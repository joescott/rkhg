<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>RKH: Installation</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">RKH
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">Installation </div>  </div>
</div>
<div class="contents">
<div class="textblock"><div class="image">
<img src="rkh_bunner.jpg" alt="rkh_bunner.jpg"/>
</div>
<p>Prev: <a class="el" href="index.html#main_page">Home</a> <br/>
 Next: <a class="el" href="_porting.html">Porting</a></p>
<p>The RKH project is organized through a hierarchical directory structure to facilitate its distribution, support and maintenance. This structure also includes application examples and demos on several platforms. The following annotated directory tree lists the most important directories and files provided in the standard RKH distribution. The explanation section immediately following the directory tree explains the structure in more detail.</p>
<p><a class="anchor" id="top_dir"></a> </p>
<div class="fragment"><pre class="fragment">&lt;RKH-root&gt;              - RKH-root directory
+---demo                - RKH demo applications
+---doc                 - RKH documentation
+---source              - RKH source files
|   copying.txt         - licence file
|   README              - change log file
\   rkh.chm             - reference manual
</pre></div><p> <b> Figure 1 Top level directories </b></p>
<p><br/>
 This section includes:</p>
<ul>
<li><a class="el" href="_installation.html#source_dir">RKH source files</a></li>
<li><a class="el" href="_installation.html#portable_dir">RKH portable directory</a></li>
<li><a class="el" href="_installation.html#demo_dir">RKH demo applications</a></li>
</ul>
<hr/>
 <h2><a class="anchor" id="source_dir"></a>
RKH source files</h2>
<p>The following figure shows the <code>\source</code> directory.</p>
<p><a class="anchor" id="source_dir_fig"></a> </p>
<div class="fragment"><pre class="fragment">(1)  &lt;RKH-root&gt;
(2)  +---demo               - Demo applications
(3)  +---doc                - Documentation
(4)  \---source             - RKH source files
(5)  |   \---include        - Platform-independent header files
(6)  |   |       rkh.h
(7)  |   |       rkhassert.h
(8)  |   |       rkhevt.h
(9)  |   |       rkhitl.h
(10) |   |       rkhmp.h
(11) |   |       rkhplat.h
(12) |   |       rkhrdy.h
(13) |   |       rkhrq.h
(14) |   |       rkhs.h 
(15) |   |       rkhtim.h
(16) |   |       rkhtrc.h
(17) |   \       rkhtype.h
(18) |   +---portable       - Platform-dependent files
(19) |   |   rkh.c
(20) |   |   rkhdyn.c
(21) |   |   rkhmp.c
(22) |   |   rkhrq.c
(23) |   |   rkhs.c
(24) |   |   rkhsma.c
(25) |   |   rkhtbl.c
(26) |   |   rkhtim.c
(27) |   \   rkhtrc.c
(28) |   copying.txt        - licence file
(29) |   README             - change log file
(30) \   rkh.chm            - reference manual
</pre></div><p> <b> Figure 2 RKH source directory </b></p>
<ul>
<li>(1) RKH-root directory </li>
<li>(2) Demo applications </li>
<li>(3) Documentation </li>
<li>(4) RKH source code files </li>
<li>(5) Contains platform-independent header files </li>
<li>(6) Framework interface </li>
<li>(7) Assert definitions </li>
<li>(8) Event data type and other related macros </li>
<li>(9) Internal use only </li>
<li>(10) Fixed-size memory block services interface </li>
<li>(11) Supported and portable platforms </li>
<li>(12) Native priority management </li>
<li>(13) Queue services interface </li>
<li>(14) Simple and cooperative scheduler interface </li>
<li>(15) Timer services interface </li>
<li>(16) Trace facility </li>
<li>(17) Defines the data types that uses RKH </li>
<li>(18) Contains platform-dependent files. </li>
<li>(19) State machine engine </li>
<li>(20) Dynamic event management, and event framework services </li>
<li>(21) Fixed-size memory block </li>
<li>(22) Queue (copy by reference) </li>
<li>(23) Simple and cooperative scheduler </li>
<li>(24) State machine application (SMA) registration. </li>
<li>(25) Binary map tables. </li>
<li>(26) Software timer. </li>
<li>(27) Platform-independent source code of runtime tracing. </li>
<li>(28) Licence file </li>
<li>(29) Change log file </li>
<li>(30) Reference manual</li>
</ul>
<hr/>
 <h2><a class="anchor" id="portable_dir"></a>
RKH portable directory</h2>
<p>All software components of the RKH, contain a platform abstraction layer. It is an indirection layer that hides the differences in hardware and software environments in which RKH operates so that the RKH source code does not need to be changed to run in a different environment. Instead, all the changes required to adapt RKH are confined to this layer. It's basically composed by a few files, <b><a class="el" href="rkhplat_8h.html" title="RKH platform-dependent interface.">rkhplat.h</a></b> and <a class="el" href="rkhtype_8h.html" title="This file defines the data types that uses RKH.">rkhtype.h</a>, which include references to the actual platform-dependent files like <b>rkhport.h</b> and <b>rkht.h</b>. The platform-specific code for the RKH port is defined by <b>rkhport.c</b>. Not all RKH ports require this file.</p>
<p>As said above, each platform, compiler or processor supported by RKH must have its own platform-dependent file, called <b>rkhport.h</b> by RKH convention. Next, each <b>rkhport.h</b> file must be referenced from <a class="el" href="rkhplat_8h.html" title="RKH platform-dependent interface.">rkhplat.h</a> header file, located in \include directory. The next listing shows an example of <b><a class="el" href="rkhplat_8h.html" title="RKH platform-dependent interface.">rkhplat.h</a></b>, where __CFV1CW63__, and __W32STVC08__ are used to instruct the C/C++ compiler to include header files from the specific RKH port directory. The key point of the design is that all platform-independent RKH source files include the same <b><a class="el" href="rkhplat_8h.html" title="RKH platform-dependent interface.">rkhplat.h</a></b> header file as the application source files.</p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">    #ifdef __CFV1CW63__</span>
<span class="preprocessor"></span><span class="preprocessor">        #include &quot;..\portable\cfv1\rkhs\cw6_3\rkhport.h&quot;</span>
<span class="preprocessor">    #endif</span>
<span class="preprocessor"></span>
<span class="preprocessor">    #ifdef __W32STVC08__</span>
<span class="preprocessor"></span><span class="preprocessor">        #include &quot;..\portable\80x86\win32_st\vc08\rkhport.h&quot;</span>
<span class="preprocessor">    #endif</span>
<span class="preprocessor">    ...</span>
</pre></div><p>The idea behind conditional compilation is that a <b>rkhport.h</b> can be selectively compiled, depending upon whether a specific value has been defined.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>The path of platform-dependent file must be relative. </dd></dl>
 <p>The RKH uses a set of integer quantities. That maybe machine or compiler dependent. These types must be defined in <b>rkht.h</b> file. The following listing shows the required data type definitions:</p>
<div class="fragment"><pre class="fragment">  <span class="comment">// Denotes a signed integer type with a width of exactly 8 bits</span>
  <span class="keyword">typedef</span> <span class="keywordtype">signed</span> <span class="keywordtype">char</span>   rkhi8_t;

  <span class="comment">// Denotes a signed integer type with a width of exactly 16 bits</span>
  <span class="keyword">typedef</span> <span class="keywordtype">signed</span> <span class="keywordtype">short</span>  rkhi16_t;

  <span class="comment">// Denotes a signed integer type with a width of exactly 32 bits</span>
  <span class="keyword">typedef</span> <span class="keywordtype">signed</span> <span class="keywordtype">long</span>       rkhi32_t;

  <span class="comment">// Denotes an unsigned integer type with a width of exactly 8 bits</span>
  <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>     rkhui8_t;

  <span class="comment">// Denotes an unsigned integer type with a width of exactly 16 bits</span>
  <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>    rkhui16_t;

  <span class="comment">// Denotes an unsigned integer type with a width of exactly 32 bits</span>
  <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> rkhui32_t;

  <span class="comment">// Denotes an unsigned integer type that is usually fastest to operate with </span>
  <span class="comment">// among all integer types.</span>
  <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  HUInt;

  <span class="comment">// Denotes a signed integer type that is usually fastest to operate with </span>
  <span class="comment">// among all integer types.</span>
  <span class="keyword">typedef</span> <span class="keywordtype">signed</span> <span class="keywordtype">int</span>        HInt;
</pre></div><p>Next, each <b>rkht.h</b> file must be referenced from <b><a class="el" href="rkhtype_8h.html" title="This file defines the data types that uses RKH.">rkhtype.h</a></b> header file, located in \include directory. The next listing shows an example of <b><a class="el" href="rkhtype_8h.html" title="This file defines the data types that uses RKH.">rkhtype.h</a></b>, where __CFV1CW63__, and __W32STVC08__ are used to instruct the C/C++ compiler to include header files from the specific RKH port directory. The key point of the design is that all platform-independent RKH source files include the same <b><a class="el" href="rkhtype_8h.html" title="This file defines the data types that uses RKH.">rkhtype.h</a></b> header file as the application source files.</p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">    #ifdef __CFV1CW63__</span>
<span class="preprocessor"></span><span class="preprocessor">        #include &quot;..\portable\cfv1\rkhs\cw6_3\rkht.h&quot;</span>
<span class="preprocessor">    #endif</span>
<span class="preprocessor"></span>
<span class="preprocessor">    #ifdef __W32STVC08__</span>
<span class="preprocessor"></span><span class="preprocessor">        #include &quot;..\portable\80x86\win32_st\vc08\rkht.h&quot;</span>
<span class="preprocessor">    #endif</span>
<span class="preprocessor">    ...</span>
</pre></div><p>The idea behind conditional compilation is that a <b>rkht.h</b> can be selectively compiled, depending upon whether a specific value has been defined.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>The path of platform-dependent file must be relative. </dd></dl>
 See the <a class="el" href="_porting.html">Porting</a> section for more information. The following figure shows the <code>\portable</code> directory.</p>
<p><a class="anchor" id="portable_dir_fig"></a> </p>
<div class="fragment"><pre class="fragment">     &lt;RKH-root&gt; 
     +---demo
     +---doc
     \---source
( 1) |   \---portable                   - RKH ports
( 2) |   |   \---80x86                  - Intel x86
( 3) |   |   |  \---win32_st            - Win32 Single-thread
( 4) |   |   |  |   \---vc08            - Microsoft Visual 2008
( 5) |   |   |  |       |   rkhport.h
( 6) |   |   |  |       |   rkht.h
( 7) |   |   \  \       \   rkhport.c
( 8) |   |   \---cfv1                   - Freescale Coldfire V1
( 9) |   |   |  \---rkhs                - Use the native scheduler
(10) |   |   |  |   \---cw6_3           - Codewarrior v6.3
(11) |   |   |  |   |       rkhport.h
(12) |   |   |  |   |       rkht.h
(13) |   |   \  \   \       rkhport.c
     |   \   +---...                    - Others
     |   |   rkh.c
     |   |   rkhdyn.c
     |   |   rkhmp.c
     |   |   rkhrq.c
     |   |   rkhs.c
     |   |   rkhsma.c
     |   |   rkhtbl.c
     |   |   rkhtim.c
     |   \   rkhtrc.c
     |   copying.txt
     |   README 
     \   rkh.chm    
</pre></div><p> <b> Figure 3 RKH portable directory </b></p>
<ul>
<li>( 1) RKH ports. The directory \portable contains platform-dependent files to be used by RKH applications. This directory structure is the most complicated because of the large number of choices available, such as CPU architectures, compilers, operating systems, and compiler options. Each of those choices is represented as a separate level of nesting in a hierarchical directory tree, so that each dimension in the multi-dimensional space of options can be extended independently from the others. Also, the directory branch for each port is individually customizable, so each branch can represent only choices relevant for a given CPU, operating system, compiler, etc. </li>
<li>( 2) Intel x86. The CPU architecture is placed as the first level of nesting within the \portable directory. Examples of CPU architectures could be: 80x86, Coldfire, S08, ARM Cortex, ARM, MSP430, etc. Please note that a separate directory is needed whenever the CPU architecture is significantly different. </li>
<li>( 3) Win32 Single-thread. The second level of nesting, under the CPU architecture, is the operating system used. </li>
<li>( 4) Microsoft Visual 2008. The next level of nesting, under each operating system directory, is the directory for the compiler used. </li>
<li>( 5) RKH platform-dependent include file. Frequently, defines the interrupt locking method, the critical section management, among other things. The key point of the design is that all platform-independent RKH source files include the same <b><a class="el" href="rkhplat_8h.html" title="RKH platform-dependent interface.">rkhplat.h</a></b> header file as the application source files. </li>
<li>( 6) RKH platform-dependent include file. In this file is defined the data types that uses RKH. The key point of the design is that all platform-independent RKH source files include the same <b><a class="el" href="rkhtype_8h.html" title="This file defines the data types that uses RKH.">rkhtype.h</a></b> header file as the application source files. </li>
<li>( 7) RKH platform-dependent source file. The platform-specific source file is optional and many ports don’t require it. </li>
<li>( 8) Freescale Coldfire V1 </li>
<li>( 9) Use the native scheduler </li>
<li>(10) Codewarrior v6.3 </li>
<li>(11-13) Idem (5-7)</li>
</ul>
<hr/>
 <h2><a class="anchor" id="demo_dir"></a>
RKH demo applications</h2>
<p>The \demo directory contains the application examples that are included in the standard RKH distribution. The structure of the \demo is the most complicated because of the large number of choices available, such as CPU architectures, compilers, operating systems, and compiler options. Each of those choices is represented as a separate level of nesting in a hierarchical directory tree, so that each dimension in the multi-dimensional space of options can be extended independently from the others. Also, the directory branch for each RKH port is individually customizable, so each branch can represent only choices relevant for a given CPU, operating system, compiler, etc.</p>
<p>Each RKH application must have its own configuration file, called <a class="el" href="rkhcfg_8h.html" title="RKH user configuration.">rkhcfg.h</a>. This file adapts and configures RKH by means of compiler definitions and macros allowing to restrict the resources consumed by RKH. Adjusting this definitions allows to reduce the ROM and RAM consumption, and to enhance the system performance in a substantial manner.</p>
<p><a class="anchor" id="demo_dir_fig"></a> </p>
<div class="fragment"><pre class="fragment">     &lt;RKH-root&gt; 
( 1) \---demo                                   - RKH demo applications
( 2) |   |   \---80x86                          - Intel x86
( 3) |   |   |  \---win32_st                    - Win32 Single-thread
( 4) |   |   |  |   \---vc08                    - Microsoft Visual 2008
( 5) |   |   |  |       \---ahsm                - State machine example
( 6) |   |   |  |           +---prj             - Project files
( 7) |   |   |  |           |       rkhcfg.h    - App source and header files
     |   |   |  |           |       main.c
     |   |   \  \           \       ...
     |   \   +---...                            - Others
     |   |   rkh.c
     |   |   rkhdyn.c
     |   |   rkhmp.c
     |   |   rkhrq.c
     |   |   rkhs.c
     |   |   rkhsma.c
     |   |   rkhtbl.c
     |   |   rkhtim.c
     |   \   rkhtrc.c
     +---doc
     +---source
     |   copying.txt
     |   README 
     \   rkh.chm    
</pre></div><p> <b> Figure 4 Demo application directories </b></p>
<ul>
<li>( 1) RKH demo applications. The \demo directory contains the application examples that are included in the standard RKH distribution. The structure of the \demo is the most complicated because of the large number of choices available, such as CPU architectures, compilers, operating systems, and compiler options. Each of those choices is represented as a separate level of nesting in a hierarchical directory tree, so that each dimension in the multi-dimensional space of options can be extended independently from the others. Also, the directory branch for each RKH port is individually customizable, so each branch can represent only choices relevant for a given CPU, operating system, compiler, etc. </li>
<li>( 2) Intel x86. The CPU architecture is placed as the first level of nesting within the \demo directory. Examples of CPU architectures could be: 80x86, Coldfire, S08, ARM Cortex, ARM, MSP430, etc. Please note that a separate directory is needed whenever the CPU architecture is significantly different. </li>
<li>( 3) Win32 Single-thread. The second level of nesting, under the CPU architecture, is the operating system used. </li>
<li>( 4) Microsoft Visual 2008. The next level of nesting, under each operating system directory, is the directory for the compiler used. </li>
<li>( 5) Finally, the example application is located in its own directory. In this case, abstract hierarchical state machine example. This application is very useful to learn and explore the Statechart and UML features. </li>
<li>( 6) The \ahsm\prj\ subdirectory contains the IDE-dependent files, like object files, executable, and among others. </li>
<li>( 7) As mentioned above, each of application that use RKH must be defined its own configuration file, <a class="el" href="rkhcfg_8h.html" title="RKH user configuration.">rkhcfg.h</a>.</li>
</ul>
<p>Prev: <a class="el" href="index.html#main_page">Home</a> <br/>
 Next: <a class="el" href="_porting.html">Porting</a> </p>
</div></div>


<hr class="footer"/><address class="footer"><small>
Generated on Wed May 9 2012 13:05:36 for RKH by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.5.1
</small></address>

</body>
</html>
